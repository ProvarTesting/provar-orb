description: |
  Checkout Code test cases from Git, run test cases and publish report
usage:
  version: 2.1
  orbs:
    provar: 'provartesting/provar@2.10.2'
  jobs:
    build:
      executor:
        name: provar/default
        tag: 11-jdk-stretch-node-browsers
      parameters:
        project_name:
          type: string
          default: DemoProject
        build_file:
          type: string
          default: build.xml
        test_plan:
          type: string
          default: "Regression"
        environment:
          type: string
          default: "Dev"
      steps:
        - checkout
        - browser-tools/install-chrome
        - browser-tools/install-chromedriver
        - run:
            command: sudo apt-get update -y && sudo apt-get install -y ant
        - provar/setup_provar
        - run:
            command: ant -Dprovar.home="/home/circleci/project/Provar_Home" -Dproject.home="/home/circleci/project/<< parameters.project_name >>"
                -Dtest.plan="<< parameters.test_plan >>" -Denvironment="<< parameters.environment >>"
                -Demail.target=<< parameters.email_target >> -f << parameters.project_name >>/ANT/<< parameters.build_file >>
            name: "Run Provar Tests"
        - store_test_results:
            path: "<< parameters.project_name >>/ANT/Results/JUnit html/"
